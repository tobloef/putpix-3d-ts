const J=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function e(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=e(r);fetch(r.href,a)}};J();const v=document.querySelector("canvas"),O=v.getContext("2d"),K=O.canvas.getBoundingClientRect();var W;const P=(W=window.devicePixelRatio)!=null?W:1,U=1/2;v.width=Math.round(K.width*P*U);v.height=Math.round(K.height*P*U);O.scale(P,P);let L=0;const Q=new ImageData(v.width,v.height),u=new ImageData(v.width,v.height),G=new Float64Array(v.width*v.height),N=Float64Array.from(G),$=u.width/u.height,j=1,_=1;let i={translation:[0,0,-5],rotation:[0,0,0]};function tt(){H()}function H(){u.data.set(Q.data),N.set(G),ot(),O.putImageData(u,0,0),L++,requestAnimationFrame(H)}const T=.5,g=5;window.addEventListener("keydown",t=>{if(t.key==="ArrowUp"){t.preventDefault();const n=b(i.rotation),e=k(n,[0,0,T]).map(o=>o[0]);i.translation=Y(i.translation,e)}if(t.key==="ArrowDown"){t.preventDefault();const n=b(i.rotation),e=k(n,[0,0,T]).map(o=>o[0]);i.translation=q(i.translation,e)}if(t.key==="ArrowLeft"){t.preventDefault();const n=b(i.rotation),e=k(n,[T,0,0]).map(o=>o[0]);i.translation=q(i.translation,e)}if(t.key==="ArrowRight"){t.preventDefault();const n=b(i.rotation),e=k(n,[T,0,0]).map(o=>o[0]);i.translation=Y(i.translation,e)}t.key==="w"&&(t.preventDefault(),i.rotation[0]+=g),t.key==="s"&&(t.preventDefault(),i.rotation[0]-=g),t.key==="a"&&(t.preventDefault(),i.rotation[1]-=g),t.key==="d"&&(t.preventDefault(),i.rotation[1]+=g),t.key==="e"&&(t.preventDefault(),i.rotation[2]+=g),t.key==="q"&&(t.preventDefault(),i.rotation[2]-=g)});const z=.5,M=R([255,0,0],z),w=R([0,255,0],z),y=R([0,0,255],z),I=R([255,255,0],z),D=R([255,0,255],z),x=R([0,255,255],z),E=[255,255,255],nt={verts:[[1,1,1],[-1,1,1],[-1,-1,1],[1,-1,1],[1,1,-1],[-1,1,-1],[-1,-1,-1],[1,-1,-1]],tris:[{verts:[0,1,2],color:[M,M,M]},{verts:[0,2,3],color:[M,M,M]},{verts:[4,0,3],color:[w,w,w]},{verts:[4,3,7],color:[w,w,w]},{verts:[5,4,7],color:[y,y,y]},{verts:[5,7,6],color:[y,y,y]},{verts:[1,5,6],color:[I,I,I]},{verts:[1,6,2],color:[I,I,I]},{verts:[4,5,1],color:[D,D,D]},{verts:[4,1,0],color:[D,D,D]},{verts:[2,6,7],color:[x,x,x]},{verts:[2,7,3],color:[x,x,x]}]};function ot(){[{translation:[0,0,0],scale:[1,1,1],rotation:[L,L,L],model:nt}].forEach(n=>{const e=n.model.verts,o=at(e,n.scale),r=ct(o,n.rotation),f=rt(r,n.translation).map(c=>{const h=q(c,i.translation),d=[-i.rotation[0],+i.rotation[1],-i.rotation[2]],m=b(d),B=mt(m);return k(B,h).map(S=>S[0])}),s=f.map(et);n.model.tris.forEach(c=>{const h=s[c.verts[0]],d=s[c.verts[1]],m=s[c.verts[2]];it(h,d,m,{z:f[c.verts[0]][2],color:c.color[0]},{z:f[c.verts[1]][2],color:c.color[1]},{z:f[c.verts[2]][2],color:c.color[2]})}),n.model.tris.forEach(c=>{const h=s[c.verts[0]],d=s[c.verts[1]],m=s[c.verts[2]];Z(h,d,E),Z(d,m,E),Z(h,m,E)})})}function et(t){const n=t[1]*_/t[2],o=t[0]*_/t[2]*u.width/$+u.width/2,r=n*u.height/j+u.height/2;return[o,r]}function rt(t,n){return t.map(e=>Y(e,n))}function at(t,n){return t.map(e=>dt(e,n))}function ct(t,n){return t.map(e=>{const o=b(n);return k(o,e).map(r=>r[0])})}function b(t){const n=F(t[0]),e=[[1,0,0],[0,Math.cos(n),-Math.sin(n)],[0,Math.sin(n),Math.cos(n)]],o=F(t[1]),r=[[Math.cos(o),0,Math.sin(o)],[0,1,0],[-Math.sin(o),0,Math.cos(o)]],a=F(t[2]),l=[[Math.cos(a),-Math.sin(a),0],[Math.sin(a),Math.cos(a),0],[0,0,1]];return C(C(e,r),l)}function F(t){return t*(Math.PI/180)}function st(t,n,e,o){const r=A(n,e,o),a=A(t,e,o),l=A(n,t,o),f=A(n,e,t);if(r===0)return[!1,[0,0,0]];const s=1e-6,c=Math.abs(r-(a+l+f))<=s,h=f/r,d=l/r,m=a/r;return[c,[h,d,m]]}function it(t,n,e,o,r,a){const[l,f]=ft([t,n,e]);for(let s=l[1];s<=f[1];s++)for(let c=l[0];c<=f[0];c++){const[h,d]=st([c,s],t,n,e);if(h){const m=ut(o.color,r.color,a.color,d),B=lt(o.z,r.z,a.z,d),V=1/B,S=c+(u.height-1-s)*u.width;V>N[S]&&(X(c,s,m),N[S]=V)}}}function lt(t,n,e,o){const r=p(t,n,o[1]);return p(r,e,o[0])}function ut(t,n,e,o){const r=[p(t[0],n[0],o[1]),p(t[1],n[1],o[1]),p(t[2],n[2],o[1])];return[p(r[0],e[0],o[0]),p(r[1],e[1],o[0]),p(r[2],e[2],o[0])]}function ft(t){if(t.length===0)return[[0,0],[0,0]];let n=[1/0,1/0],e=[-1/0,-1/0];for(const o of t)o[0]<n[0]&&(n[0]=o[0]),o[1]<n[1]&&(n[1]=o[1]),o[0]>e[0]&&(e[0]=o[0]),o[1]>e[1]&&(e[1]=o[1]);return[[Math.floor(n[0]),Math.floor(n[1])],[Math.ceil(e[0]),Math.ceil(e[1])]]}function X(t,n,e){if(t<0||n<0||t>u.width-1||n>u.height-1)return;t=Math.round(t),n=Math.round(n);const o=t*4+(u.height-1-n)*u.width*4;u.data[o+0]=e[0],u.data[o+1]=e[1],u.data[o+2]=e[2],u.data[o+3]=255}function Z(t,n,e){let o=t[0],r=t[1],a=n[0],l=n[1];const f=Math.abs(o-a)<Math.abs(r-l);f&&([o,r]=[r,o],[a,l]=[l,a]),a<o&&([o,a]=[a,o],[r,l]=[l,r]);for(let s=o;s<=a;s++){const c=a-o,h=s-o,d=c===0?1:h/c,m=Math.round(p(r,l,d));f?X(m,s,e):X(s,m,e)}}function p(t,n,e){return t*(1-e)+n*e}function A(t,n,e){return Math.abs(t[0]*(n[1]-e[1])+n[0]*(e[1]-t[1])+e[0]*(t[1]-n[1]))/2}function Y(t,n){return t.map((e,o)=>e+n[o])}function q(t,n){return t.map((e,o)=>e-n[o])}function R(t,n){return t.map(e=>e*n)}function dt(t,n){return t.map((e,o)=>e*n[o])}function C(t,n){if(t[0].length!==n.length)throw new Error("Invalid matrix multiplication.");return t.map((e,o)=>n[0].map((r,a)=>e.reduce((l,f,s)=>l+t[o][s]*n[s][a],0)))}function k(t,n){return C(t,n.map(e=>[e]))}function mt(t){return t.map((n,e)=>n.map((o,r)=>t[r][e]))}tt();
